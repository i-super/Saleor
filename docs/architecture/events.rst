Events
======

.. note::
    Events are autogenerated and will be triggered
    when certain actions are completed, such us creating the order,
    cancelling fulfillment or completing a payment.

Order events
------------

+--------------------------+--------------------------+---------------------------------------------------------------------+
| Code                     | GraphQL API value        | Description                                                         |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``placed``               | ``PLACED``               | An order was placed by the customer.                                |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``draft_placed``         | ``PLACED_FROM_DRAFT``    | An order was created from draft by the staff user.                  |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``oversold_items``       | ``OVERSOLD_ITEMS``       | An order was created from draft, but some line items were oversold. |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``canceled``             | ``CANCELED``             | The order was cancelled.                                            |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``order_paid``           | ``ORDER_PAID``           | The order was fully paid by the customer.                           |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``marked_as_paid``       | ``MARKED_AS_PAID``       | The order was manually marked as fully paid by the staff user.      |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``updated``              | ``UPDATED``              | The order was updated.                                              |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``email_sent``           | ``EMAIL_SENT``           | An email was sent to the customer.                                  |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``captured``             | ``CAPTURED``             | The payment was captured.                                           |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``refunded``             | ``REFUNDED``             | The payment was refunded.                                           |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``voided``               | ``VOIDED``               | The payment was voided.                                             |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``fulfillment_canceled`` | ``FULFILLMENT_CANCELED`` | Fulfillment for one or more of the items was canceled.              |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``restocked_items``      | ``RESTOCKED_ITEMS``      | One or more of the order's items have been resocked                 |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``fulfilled_items``      | ``FULFILLED_ITEMS``      | One or more of the order's items have been fulfilled.               |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``note_added``           | ``NOTE_ADDED``           | A note was added to the order by the staff.                         |
+--------------------------+--------------------------+---------------------------------------------------------------------+
| ``other``                | ``OTHER``                | Status used during reimporting of the legacy events.                |
+--------------------------+--------------------------+---------------------------------------------------------------------+

Events Design
-------------

The ``OrderEvent`` class contains a bunch of static methods suffixed by
``_event``. They take care of all the logic and required fields. It whether
returns an instance of ``OrderEvent``. This design has for objective to allow
delayed (or not) event creation in the database.

The main power of this design comes when one wants to create multiple
order events in one go. Instead of generating multiple create query, one
can simply pass the objects to django's |QuerySet.bulk_create|_ method.

If one simply does not want to bulk create, delay the creation, one can
directly run ``save()`` for the creation.

.. |QuerySet.bulk_create| replace:: ``QuerySet.bulk_create``
.. _QuerySet.bulk_create: https://docs.djangoproject.com/en/1.10/ref/models/querysets/#django.db.models.query.QuerySet.bulk_create
