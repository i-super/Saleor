{% extends "base.html" %}
{% load as_vertical_form from bootstrap %}
{% load gross from prices %}
{% load i18n %}

{% block title %}{{ block.super }} Â» {% trans "Your cart" %}{% endblock %}

{% block breadcrumb %}
    {{ block.super }}
<li><a href="{% url 'cart:index' %}">{% trans "Cart" %}</a></li>
{% endblock breadcrumb %}

{% block content %}
{% if cart %}
<form role="form" action="." method="post">
    {% csrf_token %}
    {{ formset.management_form }}
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>#</th><th>{% trans "Name" %}</th><th colspan="2">{% trans "Quantity" %}</th><th>{% trans "Price" %}</th>
            </tr>
        </thead>
        <tbody>
            {% for form in formset %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ form.cart_line.product }}</td>
                <td colspan="2">{{ form.quantity|as_vertical_form:False }}</td>
                <td>{% gross form.cart_line.get_price_per_item %}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="2">{% trans "Shipping" %}: {% gross cart.get_delivery_total %}</td>
                <td>
                <button class="btn" type="submit">
                    {% trans "Update" %}
                </button></td>
                <td>{% trans "Total" %}:</td>
                <td>{% gross cart.get_total %}</td>
            </tr>
        </tfoot>
    </table>
    <div class="form-group">
        <div>
            <a href="{% url "checkout:index" %}" class="btn btn-default btn-primary">Checkout</a>        
        </div>
    </div>
</form>
{% else %}
<p>
    Your cart is empty
</p>
{% endif %}
{% endblock content %}
